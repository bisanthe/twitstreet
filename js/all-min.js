var reloadInterval=60*1000;var lastUpdateMap=new Object();function ajaxLoad(d,h,g,f,c,b,a,e){if(!c&&!e){blockElementWithMsg(f)}else{if(c&&!timeToReload(lastUpdateMap[g])){return}}$.ajax({type:"get",url:d,data:h,success:function(i){lastUpdateMap[g]=new Date();unblockElement(f);if($(i).length>0){$(g).empty();$(g).append($(i))}if(typeof b=="function"){if(a!=null){b(a)}else{b(i)}}widgetLoad()}})}function timeToReload(a){if(a==null){return true}return(new Date()).getTime()-a.getTime()>reloadInterval}var defaultCommand="suggestedstocks";var lastCommand=null;$(function(){$(window).hashchange(function(){var a=location.hash;var b=a.replace(/^#!/,"");lastCommand=b;performOperation(b)});$(window).hashchange()});function performLastOperation(){performOperation(lastCommand)}function performOperation(c){var b=c.split("=")[0];if(b=="stock"){var d=c.split("=")[1];loadStock(d)}else{if(b=="user"){var d=c.split("=")[1];loadUserProfile(d)}else{if(b=="suggestedstocks"){loadSuggestedStocks()}else{if(b=="topgrossingstocks"){loadTopGrossingStocks()}else{if(b=="topgrossingusers"){loadTopGrossingUsers()}else{if(b=="searchstock"){var a=c.split("=")[1];getQuote(a)}else{if(b=="searchuser"){var a=c.split("=")[1];getUser(a)}}}}}}}}function loadLanguage(a){ajaxLoad("/lang","lang="+a,null,"body",false,reloadPage)}function reloadPage(a){location.reload(true);if(a!=null&&a.length>0){blockElementWithMsg("body",a)}}function reloadIfHashIsMyHref(a){if(isLocationEqualTo($(a).attr("href"))){performLastOperation()}}function reloadIfHashIs(a){if(isLocationEqualTo(a)){performLastOperation()}else{window.location.hash=a}}function isLocationEqualTo(a){return window.location.hash==a}function widgetLoad(){if(twttr.widgets){twttr.widgets.load()}}function drawVisualization(a){drawStockHistory(drawStockHistoryDivId[a],drawStockHistoryDateArray[a],drawStockHistoryValueArray[a],drawStockHistoryStockName[a]);drawStockDistribution(drawStockDistributionDivId,drawStockDistributionNameArray,drawStockDistributionPercentArray,drawStockDistributionStockName)}var drawStockHistoryDivId=new Array();var drawStockHistoryDateArray=new Array();var drawStockHistoryValueArray=new Array();var drawStockHistoryStockName=new Array();function drawStockHistory(h,a,f,e,g,b){drawStockHistoryDivId[h]=h;drawStockHistoryDateArray[h]=a;drawStockHistoryValueArray[h]=f;drawStockHistoryStockName[h]=e;if($(h).parent().css("display")!="none"){if(a!=null&&a.length>0){var c=new google.visualization.DataTable();c.addColumn("datetime","Date");c.addColumn("number","");c.addRows(a.length);var d=0;for(d;d<a.length;d++){c.setValue(d,0,a[d]);c.setValue(d,1,f[d])}var j=new google.visualization.AnnotatedTimeLine($(h)[0]);if(g=="lastHour"){drawTimeLineLastHour(j,c,b)}else{if(g=="simple"){drawTimeLineSimple(j,c,b)}else{if(g!=null&&g.indexOf("simple,")==0){drawTimeLineSimple(j,c,b,g.split(",")[1])}else{drawTimeLine(j,c,b)}}}google.visualization.events.addListener(j,"error",errHandler)}}}function drawTimeLine(b,c,a){b.draw(c,{colors:(a)?[a]:undefined,displayAnnotations:true,displayExactValues:true,displayRangeSelector:false,displayZoomButtons:true,fill:30,displayLegendDots:true,legendPosition:"sameRow",scaleType:"allmaximized",thickness:3,})}function drawTimeLineLastHour(b,d,a){var c=60*60*1000;b.draw(d,{colors:(a)?[a]:undefined,displayAnnotations:true,displayExactValues:true,displayRangeSelector:false,displayZoomButtons:false,fill:30,displayLegendDots:true,legendPosition:"sameRow",scaleType:"allmaximized",thickness:3,zoomStartTime:new Date(new Date().getTime()-c),})}function drawTimeLineSimple(c,e,b,d){var f=60*1000;var a=new Date(new Date().getTime()-f*d);c.draw(e,{colors:(b)?[b]:undefined,displayAnnotations:true,displayExactValues:true,displayRangeSelector:false,displayZoomButtons:false,fill:30,displayLegendDots:true,legendPosition:"sameRow",scaleType:"allmaximized",thickness:3,zoomStartTime:(d)?a:undefined})}function errHandler(a){alert(a)}var drawStockDistributionDivId=null;var drawStockDistributionNameArray=null;var drawStockDistributionPercentArray=null;var drawStockDistributionStockName=null;function reloadStockDistribution(a){if($("#stock-details-screen").hasClass("blockUI")){return}blockElementWithMsg("#stock-details-screen");$.ajax({type:"get",url:"stockdistribution",data:"stock="+a,success:function(b){unblockElement("#stock-details-screen");$("#stock-share-section").empty();$("#stock-share-section").html($(b).html());runScriptsInElement(b)}})}function redrawStockDistribution(){drawStockDistribution(drawStockDistributionDivId,drawStockDistributionNameArray,drawStockDistributionPercentArray,drawStockDistributionStockName)}function drawStockDistribution(a,c,g,h){drawStockDistributionDivId=a;drawStockDistributionNameArray=c;drawStockDistributionPercentArray=g;drawStockDistributionStockName=h;if($(a).parent().css("display")!="none"){if(c!=null&&c.length>0){var f=new google.visualization.DataTable();f.addColumn("string","User");f.addColumn("number","Share");var d=0;for(d;d<c.length;d++){f.addRow([c[d],g[d]])}var b={width:500,height:300,is3D:"true"};var e=new google.visualization.PieChart($(a)[0]);e.draw(f,b)}}}var drawUserValueHistoryDivId=null;var drawUserValueHistoryValueArray=null;var drawUserValueHistoryDateArray=null;var drawUserValueHistoryUserName=null;var drawUserRankingHistoryDivId=null;var drawUserRankingHistoryDateArray=null;var drawUserRankingHistoryRankArray=null;var drawUserRankingHistoryUserName=null;function redrawUserRankingHistory(){drawUserValueHistory(drawUserValueHistoryDivId,drawUserValueHistoryDateArray,drawUserValueHistoryValueArray,drawUserValueHistoryUserName)}function drawUserValueHistory(a,g,d,f){drawUserValueHistoryDivId=a;drawUserValueHistoryValueArray=d;drawUserValueHistoryDateArray=g;drawUserValueHistoryUserName=f;if($(a).parent().css("display")!="none"){if(g!=null&&g.length>0){var e=new google.visualization.DataTable();e.addColumn("datetime","Date");e.addColumn("number","");e.addRows(g.length);var c=0;for(c;c<g.length;c++){e.setValue(c,0,g[c]);e.setValue(c,1,d[c])}var b=new google.visualization.AnnotatedTimeLine($(a)[0]);google.visualization.events.addListener(b,"error",errHandler);b.draw(e,{colors:["#F2469C"],displayAnnotations:true,displayExactValues:true,displayRangeSelector:false,displayZoomButtons:true,fill:30,displayLegendDots:true,legendPosition:"newRow",scaleType:"allmaximized",thickness:3,})}}}function drawUserRankingHistory(a,f,g,e){drawUserRankingHistoryDivId=a;drawUserRankingHistoryDateArray=f;drawUserRankingHistoryUserName=e;drawUserRankingHistoryRankArray=g;if($(a).parent().css("display")!="none"){if(f!=null&&f.length>0){var d=new google.visualization.DataTable();d.addColumn("datetime","Date");d.addColumn("number","");d.addRows(f.length);var c=0;for(c;c<f.length;c++){d.setValue(c,0,f[c]);d.setValue(c,1,g[c])}var b=new google.visualization.AnnotatedTimeLine($(a)[0]);google.visualization.events.addListener(b,"error",errHandler);b.draw(d,{colors:["F2D046"],displayAnnotations:true,displayExactValues:true,displayRangeSelector:false,displayZoomButtons:true,fill:30,displayLegendDots:true,legendPosition:"newRow",scaleType:"allmaximized",thickness:3,})}}}
/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,e,b){var c="hashchange",h=document,f,g=$.event.special,i=h.documentMode,d="on"+c in e&&(i===b||i>7);function a(j){j=j||location.href;return"#"+j.replace(/^[^#]*#?(.*)$/,"$1")}$.fn[c]=function(j){return j?this.bind(c,j):this.trigger(c)};$.fn[c].delay=50;g[c]=$.extend(g[c],{setup:function(){if(d){return false}$(f.start)},teardown:function(){if(d){return false}$(f.stop)}});f=(function(){var j={},p,m=a(),k=function(q){return q},l=k,o=k;j.start=function(){p||n()};j.stop=function(){p&&clearTimeout(p);p=b};function n(){var r=a(),q=o(m);if(r!==m){l(m=r,q);$(e).trigger(c)}else{if(q!==m){location.href=location.href.replace(/#.*/,"")+q}}p=setTimeout(n,$.fn[c].delay)}$.browser.msie&&!d&&(function(){var q,r;j.start=function(){if(!q){r=$.fn[c].src;r=r&&r+a();q=$('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){r||l(a());n()}).attr("src",r||"javascript:0").insertAfter("body")[0].contentWindow;h.onpropertychange=function(){try{if(event.propertyName==="title"){q.document.title=h.title}}catch(s){}}}};j.stop=k;o=function(){return a(q.location.href)};l=function(v,s){var u=q.document,t=$.fn[c].domain;if(v!==s){u.title=h.title;u.open();t&&u.write('<script>document.domain="'+t+'"<\/script>');u.close();q.location.hash=v}}})();return j})()})(jQuery,this);
/*!
 * jQuery corner plugin: simple corner rounding
 * Examples and documentation at: http://jquery.malsup.com/corner/
 * version 2.12 (23-MAY-2011)
 * Requires jQuery v1.3.2 or later
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * Authors: Dave Methvin and Mike Alsup
 */
(function(c){var a=document.createElement("div").style,h=a.MozBorderRadius!==undefined,j=a.WebkitBorderRadius!==undefined,e=a.borderRadius!==undefined||a.BorderRadius!==undefined,d=document.documentMode||0,l=c.browser.msie&&((c.browser.version<8&&!d)||d<8),i=c.browser.msie&&(function(){var n=document.createElement("div");try{n.style.setExpression("width","0+0");n.style.removeExpression("width")}catch(m){return false}return true})();c.support=c.support||{};c.support.borderRadius=h||j||e;function g(m,n){return parseInt(c.css(m,n))||0}function k(m){m=parseInt(m).toString(16);return(m.length<2)?"0"+m:m}function b(o){while(o){var m=c.css(o,"backgroundColor"),n;if(m&&m!="transparent"&&m!="rgba(0, 0, 0, 0)"){if(m.indexOf("rgb")>=0){n=m.match(/\d+/g);return"#"+k(n[0])+k(n[1])+k(n[2])}return m}if(o.nodeName.toLowerCase()=="html"){break}o=o.parentNode}return"#ffffff"}function f(o,m,n){switch(o){case"round":return Math.round(n*(1-Math.cos(Math.asin(m/n))));case"cool":return Math.round(n*(1+Math.cos(Math.asin(m/n))));case"sharp":return n-m;case"bite":return Math.round(n*(Math.cos(Math.asin((n-m-1)/n))));case"slide":return Math.round(n*(Math.atan2(m,n/m)));case"jut":return Math.round(n*(Math.atan2(n,(n-m-1))));case"curl":return Math.round(n*(Math.atan(m)));case"tear":return Math.round(n*(Math.cos(m)));case"wicked":return Math.round(n*(Math.tan(m)));case"long":return Math.round(n*(Math.sqrt(m)));case"sculpt":return Math.round(n*(Math.log((n-m-1),n)));case"dogfold":case"dog":return(m&1)?(m+1):n;case"dog2":return(m&2)?(m+1):n;case"dog3":return(m&3)?(m+1):n;case"fray":return(m%2)*n;case"notch":return n;case"bevelfold":case"bevel":return m+1;case"steep":return m/2+1;case"invsteep":return(n-m)/2+1}}c.fn.corner=function(m){if(this.length==0){if(!c.isReady&&this.selector){var n=this.selector,o=this.context;c(function(){c(n,o).corner(m)})}return this}return this.each(function(v){var u=c(this),E=[u.attr(c.fn.corner.defaults.metaAttr)||"",m||""].join(" ").toLowerCase(),L=/keep/.test(E),D=((E.match(/cc:(#[0-9a-f]+)/)||[])[1]),p=((E.match(/sc:(#[0-9a-f]+)/)||[])[1]),H=parseInt((E.match(/(\d+)px/)||[])[1])||10,F=/round|bevelfold|bevel|notch|bite|cool|sharp|slide|jut|curl|tear|fray|wicked|sculpt|long|dog3|dog2|dogfold|dog|invsteep|steep/,r=((E.match(F)||["round"])[0]),s=/dogfold|bevelfold/.test(E),q={T:0,B:1},A={TL:/top|tl|left/.test(E),TR:/top|tr|right/.test(E),BL:/bottom|bl|left/.test(E),BR:/bottom|br|right/.test(E)},I,O,G,J,z,P,C,M,K,y,N,Q,B,t;if(!A.TL&&!A.TR&&!A.BL&&!A.BR){A={TL:1,TR:1,BL:1,BR:1}}if(c.fn.corner.defaults.useNative&&r=="round"&&(e||h||j)&&!D&&!p){if(A.TL){u.css(e?"border-top-left-radius":h?"-moz-border-radius-topleft":"-webkit-border-top-left-radius",H+"px")}if(A.TR){u.css(e?"border-top-right-radius":h?"-moz-border-radius-topright":"-webkit-border-top-right-radius",H+"px")}if(A.BL){u.css(e?"border-bottom-left-radius":h?"-moz-border-radius-bottomleft":"-webkit-border-bottom-left-radius",H+"px")}if(A.BR){u.css(e?"border-bottom-right-radius":h?"-moz-border-radius-bottomright":"-webkit-border-bottom-right-radius",H+"px")}return}I=document.createElement("div");c(I).css({overflow:"hidden",height:"1px",minHeight:"1px",fontSize:"1px",backgroundColor:p||"transparent",borderStyle:"solid"});O={T:parseInt(c.css(this,"paddingTop"))||0,R:parseInt(c.css(this,"paddingRight"))||0,B:parseInt(c.css(this,"paddingBottom"))||0,L:parseInt(c.css(this,"paddingLeft"))||0};if(typeof this.style.zoom!=undefined){this.style.zoom=1}if(!L){this.style.border="none"}I.style.borderColor=D||b(this.parentNode);G=c(this).outerHeight();for(J in q){z=q[J];if((z&&(A.BL||A.BR))||(!z&&(A.TL||A.TR))){I.style.borderStyle="none "+(A[J+"R"]?"solid":"none")+" none "+(A[J+"L"]?"solid":"none");P=document.createElement("div");c(P).addClass("jquery-corner");C=P.style;z?this.appendChild(P):this.insertBefore(P,this.firstChild);if(z&&G!="auto"){if(c.css(this,"position")=="static"){this.style.position="relative"}C.position="absolute";C.bottom=C.left=C.padding=C.margin="0";if(i){C.setExpression("width","this.parentNode.offsetWidth")}else{C.width="100%"}}else{if(!z&&c.browser.msie){if(c.css(this,"position")=="static"){this.style.position="relative"}C.position="absolute";C.top=C.left=C.right=C.padding=C.margin="0";if(i){M=g(this,"borderLeftWidth")+g(this,"borderRightWidth");C.setExpression("width","this.parentNode.offsetWidth - "+M+'+ "px"')}else{C.width="100%"}}else{C.position="relative";C.margin=!z?"-"+O.T+"px -"+O.R+"px "+(O.T-H)+"px -"+O.L+"px":(O.B-H)+"px -"+O.R+"px -"+O.B+"px -"+O.L+"px"}}for(K=0;K<H;K++){y=Math.max(0,f(r,K,H));N=I.cloneNode(false);N.style.borderWidth="0 "+(A[J+"R"]?y:0)+"px 0 "+(A[J+"L"]?y:0)+"px";z?P.appendChild(N):P.insertBefore(N,P.firstChild)}if(s&&c.support.boxModel){if(z&&l){continue}for(Q in A){if(!A[Q]){continue}if(z&&(Q=="TL"||Q=="TR")){continue}if(!z&&(Q=="BL"||Q=="BR")){continue}B={position:"absolute",border:"none",margin:0,padding:0,overflow:"hidden",backgroundColor:I.style.borderColor};t=c("<div/>").css(B).css({width:H+"px",height:"1px"});switch(Q){case"TL":t.css({bottom:0,left:0});break;case"TR":t.css({bottom:0,right:0});break;case"BL":t.css({top:0,left:0});break;case"BR":t.css({top:0,right:0});break}P.appendChild(t[0]);var R=c("<div/>").css(B).css({top:0,bottom:0,width:"1px",height:H+"px"});switch(Q){case"TL":R.css({left:H});break;case"TR":R.css({right:H});break;case"BL":R.css({left:H});break;case"BR":R.css({right:H});break}P.appendChild(R[0])}}}}})};c.fn.uncorner=function(){if(e||h||j){this.css(e?"border-radius":h?"-moz-border-radius":"-webkit-border-radius",0)}c("div.jquery-corner",this).remove();return this};c.fn.corner.defaults={useNative:true,metaAttr:"data-corner"}})(jQuery);
/*!
 * jQuery blockUI plugin
 * Version 2.39 (23-MAY-2011)
 * @requires jQuery v1.2.3 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2010 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */
(function(i){if(/1\.(0|1|2)\.(0|1|2)/.test(i.fn.jquery)||/^1.1/.test(i.fn.jquery)){alert("blockUI requires jQuery v1.2.3 or later!  You are using v"+i.fn.jquery);return}i.fn._fadeIn=i.fn.fadeIn;var c=function(){};var j=document.documentMode||0;var e=i.browser.msie&&((i.browser.version<8&&!j)||j<8);var f=i.browser.msie&&/MSIE 6.0/.test(navigator.userAgent)&&!j;i.blockUI=function(p){d(window,p)};i.unblockUI=function(p){h(window,p)};i.growlUI=function(t,r,s,p){var q=i('<div class="growlUI"></div>');if(t){q.append("<h1>"+t+"</h1>")}if(r){q.append("<h2>"+r+"</h2>")}if(s==undefined){s=3000}i.blockUI({message:q,fadeIn:700,fadeOut:1000,centerY:false,timeout:s,showOverlay:false,onUnblock:p,css:i.blockUI.defaults.growlCSS})};i.fn.block=function(p){return this.unblock({fadeOut:0}).each(function(){if(i.css(this,"position")=="static"){this.style.position="relative"}if(i.browser.msie){this.style.zoom=1}d(this,p)})};i.fn.unblock=function(p){return this.each(function(){h(this,p)})};i.blockUI.version=2.39;i.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:0.6,cursor:"wait"},growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:0.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1000,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,applyPlatformOpacityRules:true,onBlock:null,onUnblock:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg"};var b=null;var g=[];function d(r,G){var B=(r==window);var w=G&&G.message!==undefined?G.message:undefined;G=i.extend({},i.blockUI.defaults,G||{});G.overlayCSS=i.extend({},i.blockUI.defaults.overlayCSS,G.overlayCSS||{});var D=i.extend({},i.blockUI.defaults.css,G.css||{});var O=i.extend({},i.blockUI.defaults.themedCSS,G.themedCSS||{});w=w===undefined?G.message:w;if(B&&b){h(window,{fadeOut:0})}if(w&&typeof w!="string"&&(w.parentNode||w.jquery)){var J=w.jquery?w[0]:w;var Q={};i(r).data("blockUI.history",Q);Q.el=J;Q.parent=J.parentNode;Q.display=J.style.display;Q.position=J.style.position;if(Q.parent){Q.parent.removeChild(J)}}i(r).data("blockUI.onUnblock",G.onUnblock);var C=G.baseZ;var N=(i.browser.msie||G.forceIframe)?i('<iframe class="blockUI" style="z-index:'+(C++)+';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+G.iframeSrc+'"></iframe>'):i('<div class="blockUI" style="display:none"></div>');var M=G.theme?i('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+(C++)+';display:none"></div>'):i('<div class="blockUI blockOverlay" style="z-index:'+(C++)+';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');var L,H;if(G.theme&&B){H='<div class="blockUI '+G.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(C+10)+';display:none;position:fixed"><div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(G.title||"&nbsp;")+'</div><div class="ui-widget-content ui-dialog-content"></div></div>'}else{if(G.theme){H='<div class="blockUI '+G.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(C+10)+';display:none;position:absolute"><div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(G.title||"&nbsp;")+'</div><div class="ui-widget-content ui-dialog-content"></div></div>'}else{if(B){H='<div class="blockUI '+G.blockMsgClass+' blockPage" style="z-index:'+(C+10)+';display:none;position:fixed"></div>'}else{H='<div class="blockUI '+G.blockMsgClass+' blockElement" style="z-index:'+(C+10)+';display:none;position:absolute"></div>'}}}L=i(H);if(w){if(G.theme){L.css(O);L.addClass("ui-widget-content")}else{L.css(D)}}if(!G.theme&&(!G.applyPlatformOpacityRules||!(i.browser.mozilla&&/Linux/.test(navigator.platform)))){M.css(G.overlayCSS)}M.css("position",B?"fixed":"absolute");if(i.browser.msie||G.forceIframe){N.css("opacity",0)}var A=[N,M,L],P=B?i("body"):i(r);i.each(A,function(){this.appendTo(P)});if(G.theme&&G.draggable&&i.fn.draggable){L.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var v=e&&(!i.boxModel||i("object,embed",B?null:r).length>0);if(f||v){if(B&&G.allowBodyStretch&&i.boxModel){i("html,body").css("height","100%")}if((f||!i.boxModel)&&!B){var F=m(r,"borderTopWidth"),K=m(r,"borderLeftWidth");var y=F?"(0 - "+F+")":0;var E=K?"(0 - "+K+")":0}i.each([N,M,L],function(t,T){var z=T[0].style;z.position="absolute";if(t<2){B?z.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.boxModel?0:"+G.quirksmodeOffsetHack+') + "px"'):z.setExpression("height",'this.parentNode.offsetHeight + "px"');B?z.setExpression("width",'jQuery.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):z.setExpression("width",'this.parentNode.offsetWidth + "px"');if(E){z.setExpression("left",E)}if(y){z.setExpression("top",y)}}else{if(G.centerY){if(B){z.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"')}z.marginTop=0}else{if(!G.centerY&&B){var R=(G.css&&G.css.top)?parseInt(G.css.top):0;var S="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+R+') + "px"';z.setExpression("top",S)}}}})}if(w){if(G.theme){L.find(".ui-widget-content").append(w)}else{L.append(w)}if(w.jquery||w.nodeType){i(w).show()}}if((i.browser.msie||G.forceIframe)&&G.showOverlay){N.show()}if(G.fadeIn){var I=G.onBlock?G.onBlock:c;var q=(G.showOverlay&&!w)?I:c;var p=w?I:c;if(G.showOverlay){M._fadeIn(G.fadeIn,q)}if(w){L._fadeIn(G.fadeIn,p)}}else{if(G.showOverlay){M.show()}if(w){L.show()}if(G.onBlock){G.onBlock()}}l(1,r,G);if(B){b=L[0];g=i(":input:enabled:visible",b);if(G.focusInput){setTimeout(o,20)}}else{a(L[0],G.centerX,G.centerY)}if(G.timeout){var u=setTimeout(function(){B?i.unblockUI(G):i(r).unblock(G)},G.timeout);i(r).data("blockUI.timeout",u)}}function h(s,t){var r=(s==window);var q=i(s);var u=q.data("blockUI.history");var v=q.data("blockUI.timeout");if(v){clearTimeout(v);q.removeData("blockUI.timeout")}t=i.extend({},i.blockUI.defaults,t||{});l(0,s,t);if(t.onUnblock===null){t.onUnblock=q.data("blockUI.onUnblock");q.removeData("blockUI.onUnblock")}var p;if(r){p=i("body").children().filter(".blockUI").add("body > .blockUI")}else{p=i(".blockUI",s)}if(r){b=g=null}if(t.fadeOut){p.fadeOut(t.fadeOut);setTimeout(function(){k(p,u,t,s)},t.fadeOut)}else{k(p,u,t,s)}}function k(p,s,r,q){p.each(function(t,u){if(this.parentNode){this.parentNode.removeChild(this)}});if(s&&s.el){s.el.style.display=s.display;s.el.style.position=s.position;if(s.parent){s.parent.appendChild(s.el)}i(q).removeData("blockUI.history")}if(typeof r.onUnblock=="function"){r.onUnblock(q,r)}}function l(p,t,u){var s=t==window,r=i(t);if(!p&&(s&&!b||!s&&!r.data("blockUI.isBlocked"))){return}if(!s){r.data("blockUI.isBlocked",p)}if(!u.bindEvents||(p&&!u.showOverlay)){return}var q="mousedown mouseup keydown keypress";p?i(document).bind(q,u,n):i(document).unbind(q,n)}function n(t){if(t.keyCode&&t.keyCode==9){if(b&&t.data.constrainTabKey){var r=g;var q=!t.shiftKey&&t.target===r[r.length-1];var p=t.shiftKey&&t.target===r[0];if(q||p){setTimeout(function(){o(p)},10);return false}}}var s=t.data;if(i(t.target).parents("div."+s.blockMsgClass).length>0){return true}return i(t.target).parents().children().filter("div.blockUI").length==0}function o(p){if(!g){return}var q=g[p===true?g.length-1:0];if(q){q.focus()}}function a(w,q,A){var z=w.parentNode,v=w.style;var r=((z.offsetWidth-w.offsetWidth)/2)-m(z,"borderLeftWidth");var u=((z.offsetHeight-w.offsetHeight)/2)-m(z,"borderTopWidth");if(q){v.left=r>0?(r+"px"):"0"}if(A){v.top=u>0?(u+"px"):"0"}}function m(q,r){return parseInt(i.css(q,r))||0}})(jQuery);mainTabsArray=new Array();mainTabContentsArray=new Array();mainTabsArray.push(".stocks-tab");mainTabsArray.push(".users-tab");mainTabContentsArray.push("#stocks-container");mainTabContentsArray.push("#users-container");function showTabMain(a){tabContentId=mainTabContentsArray[jQuery.inArray(a,mainTabsArray)];var b;for(b=0;b<mainTabsArray.length;b++){if(a==mainTabsArray[b]){$(mainTabsArray[b]).addClass("youarehere");$(mainTabsArray[b]+"-right-content").fadeTo("fast",1,null)}else{$(mainTabsArray[b]).removeClass("youarehere");$(mainTabsArray[b]+"-right-content").hide()}}for(b=0;b<mainTabContentsArray.length;b++){if(tabContentId==mainTabContentsArray[b]){$(mainTabContentsArray[b]).fadeTo("fast",1,null)}else{$(mainTabContentsArray[b]).hide()}}}portfolioTabsArray=new Array();portfolioTabContentsArray=new Array();portfolioTabsArray.push(".portfolio-tab");portfolioTabsArray.push(".watchlist-tab");portfolioTabContentsArray.push("#portfolio-content");portfolioTabContentsArray.push("#watchlist-content");function showTabPortfolio(b,a){var c;for(c=0;c<portfolioTabsArray.length;c++){if(b==portfolioTabsArray[c]){$(portfolioTabsArray[c]).addClass("youarehere")}else{$(portfolioTabsArray[c]).removeClass("youarehere")}}for(c=0;c<portfolioTabContentsArray.length;c++){if(a==portfolioTabContentsArray[c]){$(portfolioTabContentsArray[c]).show()}else{$(portfolioTabContentsArray[c]).hide()}}}stockDetailsTabArray=new Array();stockDetailsTabContentArray=new Array();stockDetailsTabArray.push("#buy-sell-tab");stockDetailsTabArray.push("#stock-history-tab");stockDetailsTabArray.push("#stock-distribution-tab");stockDetailsTabArray.push("#tweets-of-user-tab");stockDetailsTabArray.push("#tweets-about-stock-tab");stockDetailsTabContentArray.push("#buy-sell-section");stockDetailsTabContentArray.push("#stock-trend-section");stockDetailsTabContentArray.push("#stock-share-section");stockDetailsTabContentArray.push("#tweets-of-user-section");stockDetailsTabContentArray.push("#tweets-about-stock-section");function showStockDetailsTab(b,a){var c;for(c=0;c<stockDetailsTabArray.length;c++){if(b==stockDetailsTabArray[c]){$(stockDetailsTabArray[c]).addClass("youarehere")}else{$(stockDetailsTabArray[c]).removeClass("youarehere")}}for(c=0;c<stockDetailsTabContentArray.length;c++){if(a==stockDetailsTabContentArray[c]){$(stockDetailsTabContentArray[c]).show()}else{$(stockDetailsTabContentArray[c]).hide()}}}function showBuySell(){showStockDetailsTab("#buy-sell-tab","#buy-sell-section")}function showStockDistribution(a){showStockDetailsTab("#stock-distribution-tab","#stock-share-section");reloadStockDistribution(a)}function showStockHistory(){showStockDetailsTab("#stock-history-tab","#stock-trend-section");drawVisualization("#detail-stock-"+$("#hiddenStockDetailsStockId").val())}function showTweetsOfUser(){showStockDetailsTab("#tweets-of-user-tab","#tweets-of-user-section")}function showTweetsAboutStock(){showStockDetailsTab("#tweets-about-stock-tab","#tweets-about-stock-section")}stockTabArray=new Array();stockTabContentArray=new Array();stockTabArray.push(".suggested-stocks-tab");stockTabArray.push(".stock-details-tab");stockTabArray.push(".top-grossing-stocks-tab");stockTabContentArray.push("#suggested-stocks-content");stockTabContentArray.push("#top-grossing-stocks-content");stockTabContentArray.push("#stock-details-content");function showStockTab(b,a){var c;for(c=0;c<stockTabArray.length;c++){if(b==stockTabArray[c]){$(stockTabArray[c]).addClass("youarehere")}else{$(stockTabArray[c]).removeClass("youarehere")}}for(c=0;c<stockTabContentArray.length;c++){if(a==stockTabContentArray[c]){$(stockTabContentArray[c]).show()}else{$(stockTabContentArray[c]).hide()}}}function showStockDetails(){showStockTab(".stock-details-tab","#stock-details-content")}function showSuggestedStocks(){showStockTab(".suggested-stocks-tab","#suggested-stocks-content")}function showTopGrossingStocks(){showStockTab(".top-grossing-stocks-tab","#top-grossing-stocks-content")}transactionsTabsArray=new Array();transactionsTabContentsArray=new Array();transactionsTabsArray.push(".currenttransactions-tab");transactionsTabsArray.push(".yourtransactions-tab");transactionsTabContentsArray.push("#currenttransactions-content");transactionsTabContentsArray.push("#yourtransactions-content");function showTabTransactions(b,a){var c;for(c=0;c<transactionsTabsArray.length;c++){if(b==transactionsTabsArray[c]){$(transactionsTabsArray[c]).addClass("youarehere")}else{$(transactionsTabsArray[c]).removeClass("youarehere")}}for(c=0;c<transactionsTabContentsArray.length;c++){if(a==transactionsTabContentsArray[c]){$(transactionsTabContentsArray[c]).show()}else{$(transactionsTabContentsArray[c]).hide()}}}$(document).ready(function(){$("#dashboard-message-field").corner("round 3px");if($("#topranks").length>0){setInterval(reloadToprank,reloadInterval)}if($("#transactions").length){setInterval(reloadCurrentTransactions,reloadInterval)}if($("#balance").length>0){setInterval(reloadBalance,reloadInterval)}if($("#portfolio").length>0){setInterval(reloadPortfolio,reloadInterval)}if($("#portfolio").length>0){setInterval(reloadWatchList,reloadInterval)}showTabMain(".stocks-tab")});function reloadBalance(){loadBalance(true)}function loadBalance(b,a){ajaxLoad("balance",null,"#balance-container","#balance-container",b,null,null,a)}function reloadPortfolio(){if($(".portfolio-tab").hasClass("youarehere")){loadPortfolio(true)}}function loadPortfolio(b,a){ajaxLoad("/portfolio",null,"#portfolio-content","#portfolio-content",b,null,null,a)}function reloadWatchList(){if($(".watchlist-tab").hasClass("youarehere")){loadWatchList(true)}}function loadWatchList(a){ajaxLoad("/watchlist",null,"#portfolio-content","#portfolio-content",a)}function addToWatchList(a){ajaxLoad("/watchlist","stock="+a+"&operation=add","#portfolio-content","#portfolio-content",false,addToWatchListCallback,a);showTabPortfolio(".watchlist-tab","#watchlist-content")}function addToWatchListCallback(a){$(".add-to-watch-list-link-"+a).hide();$(".remove-from-watch-list-link-"+a).show()}function removeFromWatchList(a){ajaxLoad("/watchlist","stock="+a+"&operation=remove","#portfolio-content","#portfolio-content",false,removeFromWatchListCallback,a);showTabPortfolio(".watchlist-tab","#watchlist-content")}function removeFromWatchListCallback(a){$(".remove-from-watch-list-link-"+a).hide();$(".add-to-watch-list-link-"+a).show()}function getQuote(a){if(a.length>0){ajaxLoad("/getquote","quote="+a,"#stocks-container","#column_center");showTabMain(".stocks-tab")}}var stockOnScreen="#hiddenStockDetailsStockId";function reloadStock(){loadStock($(stockOnScreen).val())}function loadStock(b,a){showTabMain(".stocks-tab");showStockDetails();if(b!=null){ajaxLoad("stock","stock="+b,"#stocks-container","#column_center")}}function loadSuggestedStocks(){showTabMain(".stocks-tab");showSuggestedStocks();ajaxLoad("/suggestedstocks",null,"#suggested-stocks-content","#column_center")}function loadTopGrossingStocks(){showTabMain(".stocks-tab");showTopGrossingStocks();ajaxLoad("/topgrossingstocks",null,"#top-grossing-stocks-content","#column_center")}function loadTopGrossingUsers(){showTabMain(".users-tab");showTopGrossingUsersContent();ajaxLoad("/trendyusers",null,"#users-screen","#users-screen")}function getUser(a){if(a.length>0){ajaxLoad("/getuser","getuser="+a,"#users-container","#column_center");showTabMain(".users-tab")}}var userOnScreen="#hiddenUserDetailsUserId";function reloadUserProfile(){loadUserProfile($(userOnScreen).val())}function loadUserProfile(a,b){showTabMain(".users-tab");if(a!=null){ajaxLoad("/user","user="+a,"#users-container","#column_center",b)}}function reloadCurrentTransactions(){if($(".currenttransactions-tab").hasClass("youarehere")){loadCurrentTransactions(true)}}function loadCurrentTransactions(a){ajaxLoad("transaction",null,"#transactions-content","#transactions-content",a)}function reloadUserTransactions(){loadUserTransactions(true)}function loadUserTransactions(b,a){if($(".yourtransactions-tab").hasClass("youarehere")){ajaxLoad("transaction","type=user","#transactions-content","#transactions-content",b,null,null,a)}}function showQuotePanel(b){var c=new Array("userfound","searchresult","searchnoresult","searchfailed");for(var d=0,a=c.length;d<a;++d){if(c[d]==b){$("#"+c[d]).show()}else{$("#"+c[d]).hide()}}}function buy(d,a){var b="";var c="#buy-sell-container";if(d!=$(stockOnScreen).val()){b="&response=n";c=""}ajaxLoad("a/buy","stock="+d+"&amount="+a+b,c,c,false,buySellCallback,d);showTabPortfolio(".portfolio-tab","#portfolio-content")}function sell(d,a){var b="";var c="#buy-sell-container";if(d!=$(stockOnScreen).val()){b="&response=n";c=""}ajaxLoad("a/sell","stock="+d+"&amount="+a+b,c,c,false,buySellCallback,d);showTabPortfolio(".portfolio-tab","#portfolio-content")}function buySellCallback(a){if(a==$(stockOnScreen).val()){showBuySell()}loadPortfolio(false,true);loadBalance(false,true);loadUserTransactions(false,true);loadCurrentTransactions(false)}function setup(){var c=$("#dbHost").val();var f=$("#dbPort").val();var i=$("#dbAdmin").val();var d=$("#dbAdminPassword").val();var e=$("#dbName").val();var g=$("#admin").val();var b=$("#adminPassword").val();var h=$("#consumerKey").val();var a=$("#consumerSecret").val();$.post("/setup",{dbHost:c,dbPort:f,dbAdmin:i,dbAdminPassword:d,dbName:e,admin:g,adminPassword:b,consumerKey:h,consumerSecret:a},function(m){if(m.result){window.location="/"}else{$(".error").empty();$(".error").append(document.createElement("ul"));for(var l=0,k=m.reasons.length;value=m.reasons[l],l<k;l++){var j=document.createElement("li");$(j).text(value);$(".error ul").append(j)}}})}function toprankPrevPage(){var a=parseInt($(".topRankSelect:first").val());toprank(a-1)}function toprankNextPage(){var a=parseInt($(".topRankSelect:first").val());toprank(a+1)}function reloadToprank(){toprank(null,true)}function toprank(c,b){var a=c;if(a==null){a=$(".topRankSelect:first").val()}ajaxLoad("toprank","page="+a,"#topranks-container","#topranks-loading-div",b)}function signout(){deletecookie("id");deletecookie("oauthtoken");document.location="/signout"}function deletecookie(a){document.cookie=a+"=;expires=Thu, 01-Jan-1970 00:00:01 GMT;"}function getCookie(a){if(document.cookie.length>0){c_start=document.cookie.indexOf(a+"=");if(c_start!=-1){c_start=c_start+a.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length}return unescape(document.cookie.substring(c_start,c_end))}}return""}userProfileTabsArray=new Array();userProfileTabContentsArray=new Array();userProfileTabsArray.push("#user-status-tab");userProfileTabsArray.push("#portfolio-tab");userProfileTabsArray.push("#user-tweets-tab");userProfileTabsArray.push("#user-history-tab");userProfileTabContentsArray.push("#userstatus");userProfileTabContentsArray.push("#usertweets");userProfileTabContentsArray.push("#user-trend-section");function initUserProfileTabs(){showUserProfileTab("#user-status-tab","#userstatus")}function showUserProfileTab(b,a){var c;for(c=0;c<userProfileTabsArray.length;c++){if(b==userProfileTabsArray[c]){$(userProfileTabsArray[c]).addClass("youarehere")}else{$(userProfileTabsArray[c]).removeClass("youarehere")}}for(c=0;c<userProfileTabContentsArray.length;c++){if(a==userProfileTabContentsArray[c]){$(userProfileTabContentsArray[c]).show()}else{$(userProfileTabContentsArray[c]).hide()}}}userTabArray=new Array();userTabContentArray=new Array();userTabArray.push(".top-grossing-users-tab");userTabArray.push(".user-details-tab");userTabContentArray.push("#top-grossing-users-content");userTabContentArray.push("#user-details-content");function showUserTab(b,a){var c;for(c=0;c<userTabArray.length;c++){if(b==userTabArray[c]){$(userTabArray[c]).addClass("youarehere")}else{$(userTabArray[c]).removeClass("youarehere")}}for(c=0;c<userTabContentArray.length;c++){if(a==userTabContentArray[c]){$(userTabContentArray[c]).show()}else{$(userTabContentArray[c]).hide()}}}function showUserDetailsContent(){showUserTab(".user-details-tab","#user-details-content")}function showTopGrossingUsersContent(){showUserTab(".top-grossing-users-tab","#top-grossing-users-content")}function runScriptsInElement(responseData){var scriptArray=$(responseData).find("script").prevObject;for(var i=0;i<scriptArray.length;i++){if(scriptArray[i]!=null&&scriptArray[i].text!=null){eval(scriptArray[i].text)}}}function blockElementWithMsg(a,b){if(b==null){b="Loading"}if($(a).hasClass("blockUI")){return}$(a).fadeTo("slow",0.5,null);$(a).block({message:'<img src="images/activity_indicator_32.gif" /><br>'+b})}function unblockElement(a){$(a).fadeTo("fast",1,null);$(a).unblock()}function commasep(b){b=parseFloat(b).toFixed(2);b+="";x=b.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var a=/(\d+)(\d{3})/;while(a.test(x1)){x1=x1.replace(a,"$1,$2")}return x1+x2}function getNoRecordsFound(){return"<p>No records found.</p>"}function selectAllText(a){a.focus();a.select()}function roundedInteger(a){if(parseInt(a)!=a){if(a<0){return parseInt(a-1)}else{if(a>0){return parseInt(a+1)}}}return a}function getDouble(c,a){var b=c.toFixed(2);if(b=="0.00"){if(c<0){b=b.replace("0.00","-"+a.toFixed(2))}else{if(c>0){b=b.replace("0.00",a.toFixed(2))}}}return b}function objectExists(a){return $(a).length>0}function showTweetsWithKeyWords(c,a){var b=$("#"+a).width();if(c!=null&&c.length>0){new TWTR.Widget({version:2,type:"search",search:c,rpp:20,interval:6000,width:b,height:1500,id:a,theme:{shell:{background:"#f2f2f2",color:"#000000"},tweets:{background:"#ffffff",color:"#000000",links:"#4183c4"}},features:{scrollbar:false,loop:true,live:true,hashtags:true,timestamp:true,avatars:true,toptweets:true,behavior:"all"}}).render().start()}}function showTweetsOfUserInDiv(b,a){new TWTR.Widget({version:2,type:"profile",rpp:20,interval:30000,width:500,height:300,id:a,theme:{shell:{background:"#f2f2f2",color:"#000000"},tweets:{background:"#ffffff",color:"#000000",links:"#4183c4"}},features:{scrollbar:false,loop:false,live:false,behavior:"all"}}).render().setUser(b).start()}function calculateSold(b,a){return b*a}function getTimezoneOffset(){return $("#clientTzOffset").val()};